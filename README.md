# Dungeon Builder

2D игра-песочница о строительстве подземелья в фэнтези мире.

## Концепция

Игрок строит и управляет подземельем:
- Создание многоуровневого подземелья (вглубь земли)
- Размещение комнат, мастерских, хранилищ
- Управление ресурсами и постройками
- **(Позже)** Враги, защита, экономика

**Текущая фаза:** Базовая механика строительства, управление камерой, сохранение состояния.

## Стек технологий

### Core
- **TypeScript** - строгая типизация
- **Phaser 3** - 2D игровой движок
- **React 19** - UI overlay
- **Zustand** - state management (раздельные stores)
- **Bun** - пакетный менеджер и runtime

### Инструменты
- **Vite** (Rolldown) - быстрая сборка
- **Tailwind CSS v4** - стилизация UI
- **lodash-es** - утилиты
- **neverthrow** - Result-based error handling
- **ts-expect** - exhaustive type checks

### Будущее
- **Electron** - desktop версия
- **IndexedDB** (через idb) - локальное хранилище
- **Steam** - возможная платформа (позже)

## Быстрый старт

```bash
# Установка
bun install

# Разработка
bun run dev

# Сборка
bun run build

# Линтинг
bun run lint
bun run prettier-check
```

## Структура проекта

```
src/
├── game/              # Phaser игровая логика
│   ├── scenes/        # Игровые сцены (PreloadScene, MainScene)
│   └── config.ts      # Конфигурация Phaser
├── store/             # Zustand stores (раздельные по функциям)
│   └── cameraStore.ts # Зум и позиция камеры
├── components/        # React UI компоненты (будут добавлены)
├── types/             # TypeScript типы (будут добавлены)
├── PhaserGame.tsx     # React wrapper для Phaser
├── App.tsx            # Главный компонент
└── index.tsx          # Entry point
```

## Текущие возможности

### Управление камерой
- **WASD** - движение камеры
- **Колесико мыши** - зум с фокусом на курсоре (0.5x - 3x)
- **Автосохранение** - зум и позиция сохраняются в localStorage (раздельные ключи)

### Техническое
- Адаптивный canvas (Scale.RESIZE)
- Раздельное хранение состояния (готовность к IDB миграции)
- Debounce оптимизация записи (200ms зум, 500ms позиция)

## Архитектурные решения

### State Management
- **Раздельные stores** - каждая функция в своем store
- **localStorage ключи** - независимые для упрощения миграции на IDB
- **Persist middleware** - автоматическое сохранение

### Phaser + React
- Phaser отвечает за игровую логику и рендеринг
- React для UI overlay (меню, панели, диалоги)
- Zustand как мост между ними

### Импорты
- Алиас `@/*` вместо относительных путей
- Именованные импорты (не default)
- Type imports через `type` keyword

## Документация

- **[TypeScript Style Guide](./TYPESCRIPT_STYLEGUIDE.md)** - правила написания кода для нейроагентов

## Roadmap

### v0.1 - Базовая механика (текущая)
- [x] Инициализация Phaser + React
- [x] Управление камерой (WASD, зум)
- [x] Сохранение состояния
- [ ] Сетка тайлов
- [ ] Размещение построек
- [ ] UI панель инструментов

### v0.2 - Строительство
- [ ] Типы тайлов (пол, стена, пустота)
- [ ] Типы построек (комната, мастерская, хранилище)
- [ ] Drag-to-build механика
- [ ] Удаление построек
- [ ] Множественные уровни (переключение)

### v0.3 - Ресурсы
- [ ] Система ресурсов (камень, дерево, золото)
- [ ] Стоимость построек
- [ ] Добыча ресурсов

### v0.4+ - Геймплей
- [ ] NPC рабочие
- [ ] Враги и защита
- [ ] Экономика
- [ ] Квесты/задания

## Для нейроагентов

При работе с проектом:
1. **Читай стайлгайд** - все правила там
2. **Inline types** - не создавай интерфейсы без необходимости
3. **Алиас @/** - всегда для импортов из src/
4. **neverthrow** - для обработки ошибок
5. **Раздельные stores** - не объединяй логически разные состояния

## Контрибьютинг

Проект в активной разработке. Стайлгайд обязателен к соблюдению.

## License

MIT

